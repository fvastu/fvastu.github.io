!function(t){t.fn.reflect=function(e){return e=t.extend({height:1/3,opacity:.5},e),this.unreflect().each(function(){var i=this;if(/^img$/i.test(i.tagName)){function a(){var a,s,r,n,o,c=i.width,l=i.height;if(s=Math.floor(e.height>1?Math.min(l,e.height):l*e.height),(a=t("<canvas />")[0]).getContext){n=a.getContext("2d");try{t(a).attr({width:c,height:s}),n.save(),n.translate(0,l-1),n.scale(1,-1),n.drawImage(i,0,0,c,l),n.restore(),n.globalCompositeOperation="destination-out",(o=n.createLinearGradient(0,0,0,s)).addColorStop(0,"rgba(255, 255, 255, "+(1-e.opacity)+")"),o.addColorStop(1,"rgba(255, 255, 255, 1.0)"),n.fillStyle=o,n.rect(0,0,c,s),n.fill()}catch(t){return}}else{if(!window.ActiveXObject)return;a=t("<img />").attr("src",i.src).css({width:c,height:l,marginBottom:s-l,filter:"FlipV progid:DXImageTransform.Microsoft.Alpha(Opacity="+100*e.opacity+", FinishOpacity=0, Style=1, StartX=0, StartY=0, FinishX=0, FinishY="+s/l*100+")"})[0]}t(a).css({display:"block",border:0}),(r=t(/^a$/i.test(i.parentNode.tagName)?"<span />":"<div />").insertAfter(i).append([i,a])[0]).className=i.className,t(i).data("reflected",r.style.cssText=i.style.cssText),t(r).css({width:c,height:l+s,overflow:"hidden"}),i.style.cssText="display: block; border: 0px",i.className="reflected"}i.complete?a():t(i).load(a)}})},t.fn.unreflect=function(){return this.unbind("load").each(function(){var e,i=t(this).data("reflected");void 0!==i&&(e=this.parentNode,this.className=e.className,this.style.cssText=i,t(this).data("reflected",null),e.parentNode.replaceChild(this,e))})}}(window.jQuery||window.Zepto);